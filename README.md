# HR-аналитический AI-бот

**Описание проекта:**  
Это умный помощник для анализа данных о сотрудниках компании. Он помогает HR-специалистам получать ответы на вопросы о персонале, текучести кадров, опыте сотрудников, распределении по департаментам, регионам, сервисам и формам работы, а также визуализировать данные в виде графиков. Бот отвечает на вопросы с учётом контекста предыдущих сообщений, поддерживая переписку.

## Возможности

- **Интерактивный AI-чат**  
  Пользователь задаёт вопросы вроде «Средний опыт по регионам», LLM (YandexGPT) выбирает нужную метрику, сервер вычисляет её через pandas и возвращает результат в понятной форме, с комментарием от LLM.

- **Визуализация метрик**  
  Для числовых метрик генерируются графики (`Chart.js`) прямо в интерфейсе.

- **Регистронезависимые фильтры и группировки**  
  Можно фильтровать данные по департаментам, сервисам, регионам, возрастным категориям и другим параметрам.

- **Рекомендации по ключевым метрикам**  
  Сервис `auto_recommendations_service` оценивает критичность метрик и предоставляет советы HR в виде уведомлений для действий по удержанию персонала и улучшению корпоративной среды.

## Технологии

- **Бэкенд:** Python, FastAPI, pandas, PostgreSQL
- **Фронтенд:** React, TailwindCSS, Chart.js, axios
- **AI:** YandexGPT
- **Деплой:** Яндекс.Облако

## Сценарий использования

1. Пользователь вводит вопрос о HR-метриках в чат.
2. LLM формирует JSON с названием метрики и фильтрами.
3. Сервер вызывает соответствующую функцию метрики на данных из базы.
4. Результат и график отображаются в чате.
5. Бот комментирует получившийся результат. 

## Примеры вопросов

Ниже приведены примеры вопросов, которые можно задать боту:

- **Общее количество сотрудников**
- **Количество сотрудников по отделам**
- **Количество сотрудников по регионам**
- **Количество сотрудников по полу**
- **Количество сотрудников по форме работы**
- **Динамика текучести кадров по отделам**
- **Отделы с высокой/низкой текучестью кадров**
- **Тренд увольнений по возрастным группам**
- **Средний стаж работы сотрудников в компании**
- **Средний возраст сотрудников**
- **Средний FTE сотрудников по отделам**
- **Количество сотрудников, необходимых для покрытия текущего оттока**
- **Отделы с самой высокой текучестью кадров**

[Со всеми метрикаи можно ознакомиться тут](https://github.com/jusa11/ai-hackathon/blob/main/server/modules/analytics/metrics.py)

# Структура проекта

## front/
├── public/
├── src/
│   ├── Components/ 
│   │   ├── atoms/
│   │   │   ├── AutoResizeTextArea.jsx — textarea с автоподстройкой  
│   │   │   ├── NotificationsIcon.jsx — иконка уведомлений  
│   │   │   ├── ShareOverlay.jsx — оверлей для шаринга  
│   │   │   └── UserCard.jsx — карточка пользователя  
│   │   ├── molecules/
│   │   │   ├── FormQuery.jsx — форма ввода вопросов  
│   │   │   ├── MetricCard.jsx — карточка метрики  
│   │   │   ├── MetricChart.jsx — компонент графика метрики  
│   │   │   └── NotificationsList.jsx — список уведомлений  
│   │   ├── organisms/
│   │   │   ├── ChatWithLLM.jsx — чат с AI  
│   │   │   ├── Content.jsx — контейнер для графиков и чата  
│   │   │   ├── Header.jsx — заголовок чата 
│   │   │   └── SideBar.jsx — боковое меню  
│   ├── App.jsx
│   ├── index.css
│   └── main.jsx
├── index.html

## server/
├── modules/
│   ├── analytics/ — функции расчета HR-метрик
│   │   ├── analytics_service.py — расчёт метрик
│   │   ├── metrics.py — список и описание всех метрик
│   │   └── router.py — эндпоинты для метрик
│   ├── charts/ — построение графиков (не используется, графики рисуются на фронте)
│   │   ├── create_plot.py — функции построения графиков
│   │   └── router.py — эндпоинты для графиков
│   ├── llm/ — работа с AI
│   │   ├── comment_service.py — комментарии LLM
│   │   ├── define_metric_service.py — определение метрик по запросу
│   │   └── router.py — эндпоинты AI
│   ├── recommendations/ — рекомендации HR
│   │   ├── recommendations_service.py — логика рекомендаций
│   │   └── router.py — эндпоинты рекомендаций
├── shared/ — общие утилиты и вспомогательные функции
│   ├── utils/
│   │   ├── apply_filters_and_timeframe.py — фильтры и временные рамки
│   │   ├── handle_query.py — обработка запросов
│   │   ├── metric_with_plot.py — объединение метрик и графиков
│   │   ├── parse_llm.py — парсинг ответа AI (define_metric_service)
│   │   ├── run_metric.py — универсальная функция run_metric
│   │   └── auth.py — авторизация и работа с токенами
│		├── cached_df_service.py — кэширование и хранение DataFrame
│		├── crud.py — базовые CRUD операции
│		├── database.py — подключение к PostgreSQL
│		├── db_service.py — работа с базой данных
│		├── employees.py — функции для работы с сотрудниками
│		├── general_hr_summary_stub.py — заглушка в случае ошибки определения метрики от LLM (возвращает шаблон)
│		├── models.py — SQLAlchemy модели
│		├── schemas.py — Pydantic схемы для API
├── main.py
├── .env
└── docker-compose.ym


## Возможные улучшения и дальнейшее развитие

- Добавить **режим атмосферного бота**, который периодически уведомляет команду о тенденциях в метриках.
- Поддержка исторических трендов и прогнозов HR-метрик.
- Расширение рекомендаций: предлагать резюме для отделов или сервисов, где есть отток персонала.
